# --- empty global env --- #
rm(list=ls())
# --- load packages --- #
library(tidyverse)
install.packages("tidyverse")
# --- empty global env --- #
rm(list=ls())
# --- load packages --- #
library(tidyverse)
# --- import data --- #
mammal_raw <-
readxl::read_xlsx("data/RNAvirus_Mammals_newJan2023/excel_with_alldata_unfiltered/RNAviruses-Mammals-RNA-newJan2023.xlsx")
warnings()
View(mammal_raw)
str(mammal_raw)
View(mammal_raw)
table(mammal_raw$best_query)
table("Flavi_RdRp" %in % mammal_raw$best_query)
table("Flavi_RdRp" %in% mammal_raw$best_query)
table(mammal_raw$best_query== "Flavi_RdRp")
table(mammal_raw$best_query== "Flavi_RdRp")[2]
table(mammal_raw$best_query== "Flavi_RdRp")[2]
Flavi_RdRp <- mammal_raw %>%
filter(best_query="Flavi_RdRp")
Flavi_RdRp <- mammal_raw %>%
filter(best_query=="Flavi_RdRp")
Flavi_RdRp <- mammal_raw %>%
filter(best_query=="Flavi_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
View(Flavi_RdRp)
table(mammal_raw$best_query== "Hepe-Virga_RdRp")[2]
Hepe-Virga_RdRp <- mammal_raw %>%
filter(best_query=="Hepe-Virga_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
mammal_raw %>%
filter(best_query=="Hepe-Virga_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Hepe-Virga_RdRp <- mammal_raw %>%
filter(best_query=="Hepe-Virga_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Hepe_Virga_RdRp <- mammal_raw %>%
filter(best_query=="Hepe-Virga_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Hepe_Virga_RdRp <- mammal_raw %>%
filter(best_query=="Hepe-Virga_RdRp")
Hepe_Virga_RdRp <- mammal_raw %>%
filter(best_query=="Hepe-Virga_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Nido_RdRp <- mammal_raw %>%
filter(best_query=="Nido_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
table(mammal_raw$best_query== " Negative_Mono-Chu_RdRp")[2]
table(mammal_raw$best_query== "Negative_Mono-Chu_RdRp")[2]
table(mammal_raw$best_query== "Negative_Orthomyxo_RdRp")[2]
table(mammal_raw$best_query== "Negative_Bunya-Arena_RdRp")[2]
# --- filter group based on criteria --- #
Flavi_RdRp <- mammal_raw %>%
filter(best_query=="Flavi_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Hepe_Virga_RdRp <- mammal_raw %>%
filter(best_query=="Hepe-Virga_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Nido_RdRp <- mammal_raw %>%
filter(best_query=="Nido_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Negative_Bunya-Arena_RdRp <- mammal_raw %>%
filter(best_query=="Negative_Bunya-Arena_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Negative_Bunya_Arena_RdRp <- mammal_raw %>%
filter(best_query=="Negative_Bunya-Arena_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Negative_Mono-Chu_RdRp <- mammal_raw %>%
filter(best_query=="Negative_Mono-Chu_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Negative_Mono_Chu_RdRp <- mammal_raw %>%
filter(best_query=="Negative_Mono-Chu_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
Negative_Orthomyxo_RdRp <- mammal_raw %>%
filter(best_query=="Negative_Orthomyxo_RdRp",num_hits > 4,ViralRefSeq_E < 1e-5,ViralRefSeq_ident < 90)
table(Negative_Orthomyxo_RdRp$SRA_run)
table(Flavi_RdRp$SRA_run)
table(Hepe_Virga_RdRp$SRA_run)
setdiff(table(Flavi_RdRp$SRA_run),table(Flavi_RdRp$SRA_run))
setdiff(table(Hepe_Virga_RdRp$SRA_run),table(Flavi_RdRp$SRA_run))
unique(Hepe_Virga_RdRp$SRA_run)
sum(unique(Hepe_Virga_RdRp$SRA_run))
length#(unique(Hepe_Virga_RdRp$SRA_run))
length(unique(Hepe_Virga_RdRp$SRA_run))
length(unique(mammal_raw$SRA_run))
unique(Flavi_RdRp$SRA_run)
unique(Hepe_Virga_RdRp$SRA_run)
unique(Nido_RdRp$SRA_run)
unique(Negative_Bunya_Arena_RdRp$SRA_run)
unique(Negative_Mono_Chu_RdRp$SRA_run)
unique(Negative_Orthomyxo_RdRp$SRA_run)
fileConn<-file("output.txt")
writeLines(flavi_sra, fileConn)
flavi_sra <- unique(Flavi_RdRp$SRA_run)
hepevirga_sra <- unique(Hepe_Virga_RdRp$SRA_run)
nido_sra <- unique(Nido_RdRp$SRA_run)
bunya <- unique(Negative_Bunya_Arena_RdRp$SRA_run)
mono_chu <- unique(Negative_Mono_Chu_RdRp$SRA_run)
orthomyxo <- unique(Negative_Orthomyxo_RdRp$SRA_run)
fileConn<-file("output.txt")
writeLines(flavi_sra, fileConn)
close(fileConn)
?file
fileConn<-file("data/RNAvirus_Mammals_newJan2023/sra_ids/flavi_sra.txt")
writeLines(flavi_sra, fileConn)
close(fileConn)
fileConn<-file("data/RNAvirus_Mammals_newJan2023/sra_ids/flavi_sra.txt")
writeLines(flavi_sra, fileConn)
close(fileConn)
fileConn<-file("data/RNAvirus_Mammals_newJan2023/sra_ids/hepevirga_sra.txt")
writeLines(hepevirga_sra, fileConn)
close(fileConn)
fileConn<-file("data/RNAvirus_Mammals_newJan2023/sra_ids/nido_sra.txt")
writeLines(nido_sra, fileConn)
close(fileConn)
fileConn<-file("data/RNAvirus_Mammals_newJan2023/sra_ids/bunya.txt")
writeLines(bunya, fileConn)
close(fileConn)
fileConn<-file("data/RNAvirus_Mammals_newJan2023/sra_ids/mono_chu.txt")
writeLines(mono_chu, fileConn)
close(fileConn)
fileConn<-file("data/RNAvirus_Mammals_newJan2023/sra_ids/orthomyxo.txt")
writeLines(orthomyxo, fileConn)
close(fileConn)
orthomyxo
Flavi_RdRp
### First install the "remotes" package
install.packages("remotes")
### Then install the Virusparies package
remotes::install_github("SergejRuff/Virusparies")
# --- clean glob. env. --- #
rm(list=ls())
# --- load packages --- #
library(Virusparies)
?VhgBoxplot
vhg_file <- ImportVirusTable("data/hittables_taubert/rnavirus/taubert/200055/hittables/virushunter.tsv")
path_to_hittable <-
"data/hittables_taubert/rnavirus/taubert/200055/hittables/virushunter.tsv"
vhg_file <-
ImportVirusTable(path_to_hittable)
vhPipeline <- function(vhg_file,sra_name,virustype,path){
srarun_bar <- VhgRunsBarplot(vh_file = vhg_file,groupby = "ViralRefSeq_taxonomy",
title = paste("Distribution of viral groups for",
sra_name,"for",virustype) )
ExportVirusPlot(plot = srarun_bar,file_name = "test.png",path=path)
}
path_to_hittable <-
"data/hittables_taubert/rnavirus/taubert/200055/hittables/virushunter.tsv"
vhg_file <-
ImportVirusTable(path_to_hittable)
sra_name <- "Taubert 20055"
Virustype <- "RNA virus"
path <- "output/test"
vhPipeline(vhg_file,sra_name = sra_name,virustype = Virustype,path = path)
vhPipeline <- function(vhg_file,sra_name,virustype,path){
srarun_bar <- VhgRunsBarplot(vh_file = vhg_file,groupby = "ViralRefSeq_taxonomy",
title = paste("Distribution of viral groups for",
sra_name,"for",virustype) )
ExportVirusPlot(plot = srarun_bar,file_name = "test.png",path=path)
}
path_to_hittable <-
"data/hittables_taubert/rnavirus/taubert/150001/hittables/virushunter.tsv"
vhg_file <-
ImportVirusTable(path_to_hittable)
sra_name <- "Taubert 150001"
Virustype <- "RNA virus"
path <- "output/test"
vhPipeline(vhg_file,sra_name = sra_name,virustype = Virustype,path = path)
vhPipeline <- function(vhg_file,sra_name,virustype,path){
srarun_bar <- VhgRunsBarplot(vh_file = vhg_file,groupby = "ViralRefSeq_taxonomy",
title = paste("Distribution of viral groups for",
sra_name,"for",virustype) )
ExportVirusPlot(plot = srarun_bar,file_name = "test.png",path=path)
}
path_to_hittable <-
"data/hittables_taubert/rnavirus/taubert/160149/hittables/virushunter.tsv"
vhg_file <-
ImportVirusTable(path_to_hittable)
sra_name <- "Taubert 150001"
Virustype <- "RNA virus"
path <- "output/test"
vhPipeline(vhg_file,sra_name = sra_name,virustype = Virustype,path = path)
