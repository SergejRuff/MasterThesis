) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
gtsave(rna_gt,filename = "cgt_gt.png",path = "output/TaubertDatacombined/plots/rnavirus/Gatherer/")
cgt <- cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
cgt <- cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
combined_subjects <- rbind(rna_subject,smalldna_subject,largedna_subject)
cgt <-  VhgTabularRasa(combined_subjects,title = "Taubert - Found subjects",names_ = c("Viral reference taxonomy",
"Viral reference subject",
"Count"),title_colour = "black")
cgt<- cgt%>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
cgt <- cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
cgt
gtsave(cgt,filename = "cgt_gt.png",path = "output/TaubertDatacombined/")
rm(list = ls())
library(Virusparies)
library(ggplot2)
taubert_largedna <- ImportVirusTable("data/hittables_taubert/largedna/combined_virusgatherer-cap3.tsv")
taubert_smalldna <- ImportVirusTable("data/hittables_taubert/smalldna/combined_virusgatherer-cap3.tsv")
taubert_rna <- ImportVirusTable("data/hittables_taubert/rnavirus/combined_virusgatherer-cap3.tsv")
export_path <- "output/TaubertDatacombined/plots/"
taubert_largedna <- VhgPreprocessTaxa(taubert_largedna,taxa_rank = "Family")
taubert_smalldna <- VhgPreprocessTaxa(taubert_smalldna,taxa_rank = "Family")
taubert_rna <- VhgPreprocessTaxa(taubert_rna,taxa_rank = "Family")
VhgBoxplot(taubert_largedna,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",reorder_criteria = NULL,legend_position = "right",xlabel = "Large DNA viruses",axis_title_size = 12,ytext_size = 12,
xtext_size = 11,title = "Taubert data (Gatherer)\nViral group E-values")
evalbox_large <- VhgBoxplot(taubert_largedna,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",reorder_criteria = NULL,legend_position = "right",xlabel = "Large DNA viruses",axis_title_size = 12,ytext_size = 12,
xtext_size = 11,title = "Taubert data (Gatherer)\nViral group E-values")
evalbox_small <- VhgBoxplot(taubert_smalldna,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",reorder_criteria = NULL,legend_position = "right",xlabel = "Small DNA viruses",axis_title_size = 12,ytext_size = 12,
xtext_size = 11,title = "Taubert data (Gatherer)\nViral group E-values")
evalbox_rna <- VhgBoxplot(taubert_rna ,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",reorder_criteria = NULL,legend_position = "right",xlabel = "RNA viruses",axis_title_size = 12,ytext_size = 12,
xtext_size = 11,title = "Taubert data (Gatherer)\nViral group E-values")
evalbox_large$boxp <- evalbox_large$boxp +
scale_y_continuous(limits = c(-1, 9))
evalbox_small$boxp <- evalbox_small$boxp +
scale_y_continuous(limits = c(0, 8))
evalbox_rna$boxp <- evalbox_rna$boxp +
scale_y_continuous(limits = c(-1, 30))
plot_list <- list(evalbox_large$boxp,evalbox_small$boxp,evalbox_rna$boxp)
# Adjust y-axis title margin
plot_list <- lapply(plot_list, function(p) {
p + theme(axis.title.y = element_text(margin = margin(r = 15, unit = "pt")))
})
ExportVirusPlot("taubert_evalue_grid.png",plot = plot_list,
width = 8,height = 11,units = "in",limitsize = FALSE,ncol = 1,nrow = 3,greedy = TRUE,align="h",
labels = c("A","B","C"),path = export_path)
rm(list=ls())
library(Virusparies)
library(ggplot2)
library(tidyverse)
library(gt)
m1 <- ImportVirusTable("data/Florian_data/RNA/virusgatherer-cap3.tsv")
m2 <- ImportVirusTable("data/Florian_data/largedna/virusgatherer-cap3.tsv")
m3 <- ImportVirusTable("data/Florian_data/smalldna/virusgatherer-cap3.tsv")
m1 <- VhgPreprocessTaxa(m1,taxa_rank = "Family")
m2 <- VhgPreprocessTaxa(m2,taxa_rank = "Family")
m3 <- VhgPreprocessTaxa(m3,taxa_rank = "Family")
?VhgBoxplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_ident")
VhgBoxplot(m1,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted"
,title = "Pfaff data (Gatherer)\nViral reference identity",xlabel = "RNA viruses",y_column = "ViralRefSeq_ident")
VhgBoxplot(m2,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",y_column = "ViralRefSeq_ident",title = "Pfaff data (Gatherer)\nViral reference identity",xlabel = "Large DNA viruses")
VhgBoxplot(m3,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",
plot_text = 1,title = "Pfaff data (Gatherer)\nViral reference identity",xlabel = "Small DNA viruses",y_column = "ViralRefSeq_ident")
VhgBoxplot(m3,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",title = "Pfaff data (Gatherer)\nViral reference identity",xlabel = "Small DNA viruses",y_column = "ViralRefSeq_ident")
ExportVirusPlot(plot = sra_m1$plot,"sra_m1_ident.png",path = "output/Florian/",
units = "in",limitsize = FALSE,width = 8,height = 6)
sra_m1 <- VhgBoxplot(m1,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted"
,title = "Pfaff data (Gatherer)\nViral reference identity",xlabel = "RNA viruses",y_column = "ViralRefSeq_ident")
sra_m2 <- VhgBoxplot(m2,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",y_column = "ViralRefSeq_ident",title = "Pfaff data (Gatherer)\nViral reference identity",xlabel = "Large DNA viruses")
sra_m3 <- VhgBoxplot(m3,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",title = "Pfaff data (Gatherer)\nViral reference identity",xlabel = "Small DNA viruses",y_column = "ViralRefSeq_ident")
ExportVirusPlot(plot = sra_m1$boxp,"sra_m1_ident.png",path = "output/Florian/",
units = "in",limitsize = FALSE,width = 8,height = 6)
ExportVirusPlot(plot = sra_m2$boxp,"sra_m2_ident.png",path = "output/Florian/",
units = "in",limitsize = FALSE,width = 8,height = 6)
ExportVirusPlot(plot = sra_m3$boxp,"sra_m3_ident.png",path = "output/Florian/",
units = "in",limitsize = FALSE,width = 8,height = 6)
names(m1)
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# plot 4: Virusgatherer plot for ViralRefSeq_taxonomy agains contig length
plot5 <- VhgBoxplot(vg_file,x_column = "ViralRefSeq_taxonomy",y_column = "contig_len")
plot5
sra_m1 <- VhgBoxplot(m1,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted"
,title = "Pfaff data (Gatherer)\nContig length",xlabel = "RNA viruses",y_column = "contig_len")
sra_m2 <- VhgBoxplot(m2,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",y_column = "contig_len",title = "Pfaff data (Gatherer)\nContig length",xlabel = "Large DNA viruses")
sra_m3 <- VhgBoxplot(m3,x_column = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",title = "Pfaff data (Gatherer)\nContig length",xlabel = "Small DNA viruses",y_column = "contig_len")
ExportVirusPlot(plot = sra_m1$boxp,"sra_m1_contig_len.png",path = "output/Florian/",
units = "in",limitsize = FALSE,width = 8,height = 6)
ExportVirusPlot(plot = sra_m2$boxp,"sra_m2_contig_len.png",path = "output/Florian/",
units = "in",limitsize = FALSE,width = 8,height = 6)
ExportVirusPlot(plot = sra_m3$boxp,"sra_m3_contig_len.png",path = "output/Florian/",
units = "in",limitsize = FALSE,width = 8,height = 6)
rm(list=ls())
library(Virusparies)
library(ggplot2)
library(tidyverse)
library(gt)
m1 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Flavi/virusgatherer-cap3.tsv")
m2 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/hepevirga/virusgatherer-cap3.tsv")
m3 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Nido/virusgatherer-cap3.tsv")
m4 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Bunya/virusgatherer-cap3.tsv")
m5 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Mono_chu_08july_RNAvirus_nofil_1/virusgatherer-cap3.tsv")
m6 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/orthomyxo_20july_RNAvirus_nofil_1/virusgatherer-cap3.tsv")
combined_ga <- CombineHittables(m1,m2,m3,m4,m5,m6)
combined_ga <- VhgPreprocessTaxa(combined_ga,taxa_rank = "Family")
combined_ga <- VhgPreprocessTaxa(combined_ga,taxa_rank = "Family")
combined_ga <- VhgSubsetHittable(combined_ga,ViralRefSeq_E_criteria = 1e-5)
VhgRunsBarplot(combined_ga,groupby = "ViralRefSeq_taxonomy",theme_choice = "linedraw_dotted",
plot_text = 1,title = "Mammal sequence data (Gatherer)\nDistribution of viral groups detected across query sequences",group_unwanted_phyla = "rna")
VhgGetSubject(combined_ga,groupby = "ViralRefSeq_taxonomy",extract_brackets = TRUE,group_unwanted_phyla = "rna")
subject <- VhgGetSubject(combined_ga,groupby = "ViralRefSeq_taxonomy",extract_brackets = TRUE,group_unwanted_phyla = "rna")
SummarizeViralStats(combined_ga,groupby = "ViralRefSeq_taxonomy",
metric = "ViralRefSeq_ident",metric_cutoff = 90,filter_cutoff = 1e-5,
show_total = TRUE,extra_stats = c("median","Q1","Q3",
"min","max"),group_unwanted_phyla = "rna" )
stats <- SummarizeViralStats(combined_ga,groupby = "ViralRefSeq_taxonomy",
metric = "ViralRefSeq_ident",metric_cutoff = 90,filter_cutoff = 1e-5,
show_total = TRUE,extra_stats = c("median","Q1","Q3",
"min","max"),group_unwanted_phyla = "rna" )
View(stats)
SummarizeViralStats(combined_ga,groupby = "ViralRefSeq_taxonomy",
metric = "ViralRefSeq_ident",metric_cutoff = 90,filter_cutoff = 1e-5,
show_total = TRUE,extra_stats = c("median","Q1","Q3",
"min","max"),group_unwanted_phyla = "rna",sort_by = "total",top_n = 10 )
stats <- SummarizeViralStats(combined_ga,groupby = "ViralRefSeq_taxonomy",
metric = "ViralRefSeq_ident",metric_cutoff = 90,filter_cutoff = 1e-5,
show_total = TRUE,extra_stats = c("median","Q1","Q3",
"min","max"),group_unwanted_phyla = "rna",sort_by = "total")
stats
library(dplyr)
# Your tibble data (assuming it's named 'data')
filtered_data <- stats %>%
filter(!ViralRefSeq_taxonomy %in% c("unclassified", "Non-RNA-virus")) %>%
arrange(desc(total)) %>%  # Sorting by the 'total' column in descending order
slice_head(n = 10)        # Selecting the top 10 rows
filtered_data
combined_ga
stats <- SummarizeViralStats(combined_ga,groupby = "ViralRefSeq_taxonomy",
metric = "ViralRefSeq_ident",metric_cutoff = 90,filter_cutoff = 1e-5,
show_total = TRUE,extra_stats = c("median","Q1","Q3"),group_unwanted_phyla = "rna",sort_by = "total")
stats %>%
filter(!ViralRefSeq_taxonomy %in% c("unclassified", "Non-RNA-virus")) %>%
arrange(desc(total)) %>%  # Sorting by the 'total' column in descending order
slice_head(n = 10)        # Selecting the top 10 rows
filtered_data <- stats %>%
filter(!ViralRefSeq_taxonomy %in% c("unclassified", "Non-RNA-virus")) %>%
filter(ViralRefSeq_taxonomy != "Total") %>%
arrange(desc(total)) %>%
slice_head(n = 10)
# Extract the "Total" row
total_row <- stats %>% filter(ViralRefSeq_taxonomy == "Total")
# Combine the top 10 with the "Total" row
final_result <- bind_rows(filtered_data, total_row)
# Display the final result
print(final_result)
# Your tibble data (assuming it's named 'data')
filtered_data <- stats %>%
filter(!ViralRefSeq_taxonomy %in% c("unclassified", "Non-RNA-virus")) %>%
filter(ViralRefSeq_taxonomy != "Total") %>%
arrange(desc(total)) %>%
slice_head(n = 10)
filtered_data
VhgTabularRasa(filtered_data)
VhgTabularRasa(filtered_data,title = "Top 10 Viral Families by Sequence Identity")
VhgTabularRasa(filtered_data,title = "Top 10 Viral Families by Sequence Identity",
names_ = c("Viral taxonomy","<90 %",">=90 %","Total","Median","Q1","Q3"))
VhgTabularRasa(filtered_data,title = "Top 10 Viral Families by Sequence Identity",
names_ = c("Viral taxonomy","Identity < 90%", "Identity ≥ 90%","Total","Median","Q1","Q3"))
ident_gt <- VhgTabularRasa(filtered_data,title = "Top 10 Viral Families by Sequence Identity",
names_ = c("Viral taxonomy","Identity < 90%", "Identity ≥ 90%","Total","Median","Q1","Q3"),title_colour = "black")
ident_gt %>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
ident_gt %>%
fmt_number(
columns = vars(Median, Q1, Q3),
decimals = 2
) %>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
# Print the table
print(ident_gt)
ident_gt %>%
fmt_number(
columns = c("Median", "Q1", "Q3"),
decimals = 2
) %>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
gtsave(ident_gt,filename = "top10_iden_mammal.png",path = "output/mammals/")
combined_ga <- CombineHittables(m1,m2,m3,m4,m5,m6)
# combined_ga <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/excel_with_alldata_unfiltered/RNAviruses-Mammals-RNA-newJan2023.tsv")
combined_ga <- VhgPreprocessTaxa(combined_ga,taxa_rank = "Family")
combined_ga <- VhgSubsetHittable(combined_ga,ViralRefSeq_E_criteria = 1e-5)
VhgSubsetHittable(combined_ga,group_column = "ViralRefSeq_taxonomy",
virus_groups = c("Arteriviridae", "Picobirnaviridae","Fiersviridae",
"Flaviviridae","Astroviridae","Tombusviridae","Steitzviridae",
"Partitiviridae","Picornaviridae","unclassified Pisuviricota"))
gsa_subset <- VhgSubsetHittable(combined_ga,group_column = "ViralRefSeq_taxonomy",
virus_groups = c("Arteriviridae", "Picobirnaviridae","Fiersviridae",
"Flaviviridae","Astroviridae","Tombusviridae","Steitzviridae",
"Partitiviridae","Picornaviridae","unclassified Pisuviricota"))
VhgGetSubject(combined_ga,groupby = "ViralRefSeq_taxonomy",extract_brackets = TRUE,group_unwanted_phyla = "rna")
grouped_data <- t %>%
group_by(Processed_ViralRefSeq_subject) %>%
summarise(subject_count = sum(subject_count), .groups = 'drop') %>%
arrange(desc(subject_count))
t
t <- VhgGetSubject(combined_ga,groupby = "ViralRefSeq_taxonomy",extract_brackets = TRUE,group_unwanted_phyla = "rna")
t
grouped_data <- t %>%
group_by(Processed_ViralRefSeq_subject) %>%
summarise(subject_count = sum(subject_count), .groups = 'drop') %>%
arrange(desc(subject_count))
# Print the result
print(grouped_data)
# Assuming 't' is your data frame
grouped_data <- t %>%
group_by(ViralRefSeq_taxonomy, Processed_ViralRefSeq_subject) %>%
summarise(subject_count = sum(subject_count), .groups = 'drop') %>%
arrange(desc(subject_count))
# Print the result
print(grouped_data)
t <- VhgGetSubject(combined_ga,groupby = "ViralRefSeq_taxonomy",extract_brackets = TRUE)
# Assuming 't' is your data frame
grouped_data <- t %>%
group_by(ViralRefSeq_taxonomy, Processed_ViralRefSeq_subject) %>%
summarise(subject_count = sum(subject_count), .groups = 'drop') %>%
arrange(desc(subject_count))
# Print the result
print(grouped_data)
grouped_data%>%
slice_head(n = 10)
grouped_data <- grouped_data%>%
slice_head(n = 10)
grouped_data %>% gt()
VhgTabularRasa(grouped_data,title = "Top 10 Viral Subjects",
names_ = c("Viral taxonomy","Viral subjects","subject count"),title_colour = "black")
viral_co<- VhgTabularRasa(grouped_data,title = "Top 10 Viral Subjects",
names_ = c("Viral taxonomy","Viral subjects","subject count"),title_colour = "black")
viral_co%>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
739+247
viral_co <- viral_co%>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
gtsave(viral_co,filename = "viral_co_mammal.png",path = "output/mammals/")
filtered_data <- stats %>%
filter(!ViralRefSeq_taxonomy %in% c("unclassified", "Non-RNA-virus")) %>%
filter(ViralRefSeq_taxonomy != "Total") %>%
arrange(desc(total)) %>%
slice_head(n = 10)
ident_gt <- VhgTabularRasa(filtered_data,title = "Top 10 Viral Families by Sequence Identity",
names_ = c("Viral taxonomy","Identity < 90%", "Identity ≥ 90%","Total","Median","Q1","Q3"),title_colour = "black")
ident_gt <- ident_gt %>%
fmt_number(
columns = c("Median", "Q1", "Q3"),
decimals = 2
) %>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
ident_gt
gtsave(ident_gt,filename = "top10_iden_mammal.png",path = "output/mammals/")
gsa_subset <- VhgSubsetHittable(combined_ga,group_column = "ViralRefSeq_taxonomy",
virus_groups = c("Arteriviridae", "Picobirnaviridae","Fiersviridae",
"Flaviviridae","Astroviridae","Tombusviridae","Steitzviridae",
"Partitiviridae","Picornaviridae","unclassified Pisuviricota"))
unique(gsa_subset$ViralRefSeq_taxonomy)
t <- VhgGetSubject(gsa_subset,groupby = "ViralRefSeq_taxonomy",extract_brackets = TRUE)
grouped_data <- t %>%
group_by(ViralRefSeq_taxonomy, Processed_ViralRefSeq_subject) %>%
summarise(subject_count = sum(subject_count), .groups = 'drop') %>%
arrange(desc(subject_count))
print(grouped_data)
grouped_data <- grouped_data%>%
slice_head(n = 10)
viral_co<- VhgTabularRasa(grouped_data,title = "Top 10 Viral Subjects",
names_ = c("Viral taxonomy","Viral subjects","subject count"),title_colour = "black")
viral_co <- viral_co%>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
gtsave(viral_co,filename = "viral_co_mammal.png",path = "output/mammals/")
116/174
rm(list=ls())
library(Virusparies)
library(ggplot2)
library(tidyverse)
library(gt)
m1 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Flavi/virusgatherer-cap3.tsv")
m2 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/hepevirga/virusgatherer-cap3.tsv")
m3 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Nido/virusgatherer-cap3.tsv")
m4 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Bunya/virusgatherer-cap3.tsv")
m5 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Mono_chu_08july_RNAvirus_nofil_1/virusgatherer-cap3.tsv")
m6 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/orthomyxo_20july_RNAvirus_nofil_1/virusgatherer-cap3.tsv")
combined_ga <- CombineHittables(m1,m2,m3,m4,m5,m6)
combined_ga <- VhgPreprocessTaxa(combined_ga,taxa_rank = "Family")
boxplot_con <-VhgBoxplot(combined_ga,x_column = "ViralRefSeq_taxonomy",y_column = "contig_len",contiglen_log10_scale = TRUE,
theme_choice = "linedraw_dotted",group_unwanted_phyla = "rna")
View(boxplot_con)
boxplot_con[["summary_stats"]]
379/1070
View(boxplot_con[["summary_stats"]])
310/312
rm(list=ls())
library(Virusparies)
library(ggplot2)
library(tidyverse)
library(gt)
m1 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Flavi/virusgatherer-cap3.tsv")
m2 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/hepevirga/virusgatherer-cap3.tsv")
m3 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Nido/virusgatherer-cap3.tsv")
m4 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Bunya/virusgatherer-cap3.tsv")
m5 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Mono_chu_08july_RNAvirus_nofil_1/virusgatherer-cap3.tsv")
m6 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/orthomyxo_20july_RNAvirus_nofil_1/virusgatherer-cap3.tsv")
combined_ga <- CombineHittables(m1,m2,m3,m4,m5,m6)
combined_ga <- VhgPreprocessTaxa(combined_ga,taxa_rank = "Family")
combined_ga <- VhgSubsetHittable(combined_ga,ViralRefSeq_E_criteria = 1e-5)
View(combined_ga)
rm(list=ls())
library(Virusparies)
library(ggplot2)
library(tidyverse)
library(gt)
m1 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Flavi/virusgatherer-cap3.tsv")
VhgRunsBarplot(combined_ga,groupby = "best_query",theme_choice = "linedraw_dotted",
plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups detected across query sequences")
VhgRunsBarplot(m1,groupby = "best_query",theme_choice = "linedraw_dotted",
plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups detected across query sequences")
m1 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Flavi/virushunter.tsv")
VhgRunsBarplot(m1,groupby = "best_query",theme_choice = "linedraw_dotted",
plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups detected across query sequences")
sra <- VhgRunsBarplot(m1,groupby = "best_query",theme_choice = "linedraw_dotted",
plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups detected across query sequences")
ExportVirusPlot(plot = sra$plot,"hunter_flavi_sra.png",path = "output/mammals/",
units = "in",limitsize = FALSE,width = 10,height = 13)
rm(list=ls())
library(Virusparies)
library(ggplot2)
library(tidyverse)
library(gt)
m1 <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/mammals/Flavi/virushunter.tsv")
VhgRunsBarplot(m1,groupby = "best_query",theme_choice = "linedraw_dotted",plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups detected across query sequences",plot_text_size = 4)
VhgRunsBarplot(m1,groupby = "best_query",theme_choice = "linedraw_dotted",plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups detected in queries",plot_text_size = 4)
VhgRunsBarplot(m1,groupby = "best_query",theme_choice = "linedraw_dotted",plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups across queries",plot_text_size = 4)
ExportVirusPlot(plot = sra$plot,"hunter_flavi_sra.png",path = "output/mammals/",
ExportVirusPlot(plot = sra$plot,"hunter_flavi_sra.png",path = "output/mammals/",
units = "in",limitsize = FALSE,width = 10,height = 13)
sra <- VhgRunsBarplot(m1,groupby = "best_query",theme_choice = "linedraw_dotted",plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups across queries",plot_text_size = 4)
ExportVirusPlot(plot = sra$plot,"hunter_flavi_sra.png",path = "output/mammals/",
units = "in",limitsize = FALSE,width = 10,height = 13)
m1<- VhgSubsetHittable(m1,ViralRefSeq_E_criteria = 1e-5)
sra <- VhgRunsBarplot(m1,groupby = "best_query",theme_choice = "linedraw_dotted",plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups across queries",plot_text_size = 4)
sra
m1<- VhgSubsetHittable(m1,ViralRefSeq_E_criteria = 1e-5)
sra <- VhgRunsBarplot(m1,groupby = "best_query",theme_choice = "linedraw_dotted",plot_text = 1,title = "Mammal sequence data (Hunter)\nDistribution of viral groups across queries",plot_text_size = 4)
ExportVirusPlot(plot = sra$plot,"hunter_flavi_sra.png",path = "output/mammals/",
units = "in",limitsize = FALSE,width = 10,height = 13)
library(Virusparies)
file <- ImportVirusTable("data/RNAvirus_Mammals_newJan2023/excel_with_alldata_unfiltered/RNAviruses-Mammals-RNA-newJan2023.tsv")
file_filter <- VhgSubsetHittable(file,num_hits_min = 4,ViralRefSeq_E_criteria = 1e-5,
ViralRefSeq_ident_criteria = -90)
VhgRunsBarplot(file_filter,plot_text = 1,theme_choice = "linedraw_dotted",title = "Overview of all profiles in Mammal data\nDistribution of viral groups detected across query sequences",
title_size = 11,axis_title_size = 12,xtext_size = 12,subtitle_size = 11)
t <- unique(file_filter$best_query)
# Idea: Add VhgHist to Virusparies with ability to plot
# 1 histgram for all
# hist by group
# seperate into ridge plot
rm(list = ls())
library(Virusparies)
library(tidyverse)
library(ggridges)
vh_file <- ImportVirusTable("/media/sergej/EXTERNAL_US/git_clone/RscriptsMasterthesis/data/RNAvirus_Mammals_newJan2023/excel_with_alldata_unfiltered/RNAviruses-Mammals-RNA-newJan2023.tsv")
table(vh_file$ViralRefSeq_ident)
table(vh_file$ViralRefSeq_contigs)
table(vh_file$ViralRefSeq_E)
vh_file$ViralRefSeq_E[1]
