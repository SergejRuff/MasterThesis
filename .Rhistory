rows = 1:6
) %>%
tab_spanner(
label = "Small DNA Viruses",
columns = vars(
Viral_reference_taxonomy, Viral_reference_subject, Count
),
rows = 7
) %>%
tab_spanner(
label = "Large DNA Viruses",
columns = vars(
Viral_reference_taxonomy, Viral_reference_subject, Count
),
rows = 8:12
)
cgt%>%
tab_spanner(
label = "RNA Viruses",
columns = vars(
Viral_reference_taxonomy, Viral_reference_subject, Count
),
rows = 1:6
) %>%
tab_spanner(
label = "Small DNA Viruses",
columns = vars(
Viral_reference_taxonomy, Viral_reference_subject, Count
),
rows = 7
)
cgt%>%
tab_spanner(
label = "RNA Viruses",
columns = vars(
Viral_reference_taxonomy, Viral_reference_subject, Count
)
) %>%
tab_spanner(
label = "Small DNA Viruses",
columns = vars(
Viral_reference_taxonomy, Viral_reference_subject, Count
),
rows = 7
)
cgt%>%
tab_spanner(
label = "RNA Viruses",
columns = vars(
Viral_reference_taxonomy, Viral_reference_subject, Count
)
) %>%
tab_spanner(
label = "Small DNA Viruses",
columns = vars(
Viral_reference_taxonomy, Viral_reference_subject, Count
)
)
cgt%>%
tab_spanner(
label = "RNA Viruses",
columns = vars(
Viral_reference_taxonomy, Viral_reference_subject, Count
)
)
cgt%>%
tab_spanner(
label = "RNA Viruses",
columns = c(
Viral_reference_taxonomy, Viral_reference_subject, Count
)
)
combined_subjects <- combined_subjects %>%
mutate(Group = case_when(
row_number() <= 6 ~ "RNA Viruses",
row_number() == 7 ~ "Small DNA Viruses",
row_number() >= 8 ~ "Large DNA Viruses"
))
# --- load packages --- #
library(Virusparies)
rm(list = ls())
library(Virusparies)
library(gt)
# set sys env for brave executable for gtsave
# Sys.setenv(
#   CHROMOTE_CHROME = "C:/Program Files/BraveSoftware/Brave-Browser/Application/brave.exe"
# )
rna <- ImportVirusTable("data/hittables_taubert/rnavirus/combined_virusgatherer-cap3.tsv")
smalldna <- ImportVirusTable("data/hittables_taubert/smalldna/combined_virusgatherer-cap3.tsv")
largedna <- ImportVirusTable("data/hittables_taubert/largedna/combined_virusgatherer-cap3.tsv")
rna <- VhgSubsetHittable(rna,ViralRefSeq_E_criteria = 1e-5)
smalldna <- VhgSubsetHittable(smalldna,ViralRefSeq_E_criteria = 1e-5)
largedna <- VhgSubsetHittable(largedna,ViralRefSeq_E_criteria = 1e-5)
rna <- VhgPreprocessTaxa(rna,taxa_rank = "Family")
smalldna <- VhgPreprocessTaxa(smalldna,taxa_rank = "Family")
largedna <- VhgPreprocessTaxa(largedna,taxa_rank = "Family")
rna_subject <- VhgGetSubject(rna,groupby = "ViralRefSeq_taxonomy",extract_brackets = TRUE)
smalldna_subject <- VhgGetSubject(smalldna,groupby = "ViralRefSeq_taxonomy",extract_brackets = TRUE)
largedna_subject <- VhgGetSubject(largedna,groupby = "ViralRefSeq_taxonomy",extract_brackets = TRUE)
combined_subjects <- rbind(rna_subject,smalldna_subject,largedna_subject)
combined_subjects
VhgTabularRasa(combined_subjects,title = "Taubert - Found subjects",names_ = c("Viral reference taxonomy",
"Viral reference subject",
"Count","Category"),title_colour = "black")
cgt <-  VhgTabularRasa(combined_subjects,title = "Taubert - Found subjects",names_ = c("Viral reference taxonomy",
"Viral reference subject",
"Count","Category"),title_colour = "black")
cgt%>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
combined_subjects %>%
gt() %>%
tab_header(
title = "Taubert - Found subjects"
) %>%
cols_label(
Viral_reference_taxonomy = "Viral reference taxonomy",
Viral_reference_subject = "Viral reference subject",
Count = "Count"
) %>%
row_group(
group = Group
)
combined_subjects <- combined_subjects %>%
mutate(Group = case_when(
row_number() <= 6 ~ "RNA Viruses",
row_number() == 7 ~ "Small DNA Viruses",
row_number() >= 8 ~ "Large DNA Viruses"
))
library(tidyverse)
combined_subjects <- combined_subjects %>%
mutate(Group = case_when(
row_number() <= 6 ~ "RNA Viruses",
row_number() == 7 ~ "Small DNA Viruses",
row_number() >= 8 ~ "Large DNA Viruses"
))
combined_subjects %>%
gt() %>%
tab_header(
title = "Taubert - Found subjects"
) %>%
cols_label(
Viral_reference_taxonomy = "Viral reference taxonomy",
Viral_reference_subject = "Viral reference subject",
Count = "Count"
) %>%
row_group(
group = Group
)
# Sample data
combined_subjects <- data.frame(
Viral_reference_taxonomy = c(
"Hepeviridae", "Kolmioviridae", "Kolmioviridae", "Kolmioviridae", "Kolmioviridae",
"Totiviridae", "Hepadnaviridae", "Orthoherpesviridae", "Orthoherpesviridae",
"Poxviridae", "Poxviridae", "Poxviridae"
),
Viral_reference_subject = c(
"putative nonstructural polyprotein [Paslahepevirus balayani]",
"delta antigen [Hepatitis delta virus]",
"delta antigen [Snake deltavirus F18-5]",
"large delta antigen [Hepatitis delta virus]",
"small delta antigen [hepatitis D virus 1]",
"RNA polymerase, partial [Saccharomyces cerevisiae virus L-BC (La)]",
"polymerase [Hepatitis B virus]",
"DNA polymerase catalytic subunit [Human betaherpesvirus 5]",
"helicase-primase helicase subunit [Panine betaherpesvirus 2]",
"Ribonucleotide reductase small subunit [Eptesipox virus]",
"ribonucleotide reductase small subunit [Cotia virus SPAn232]",
"ribonucleotide reductase small subunit [Skunkpox virus]"
),
Count = c(1, 1, 3, 2, 2, 1, 1, 1, 1, 2, 1, 1)
)
# Add a group column to indicate the row groups
combined_subjects <- combined_subjects %>%
mutate(Group = case_when(
row_number() <= 6 ~ "RNA Viruses",
row_number() == 7 ~ "Small DNA Viruses",
row_number() >= 8 ~ "Large DNA Viruses"
))
# Create gt table
cgt <- combined_subjects %>%
gt() %>%
tab_header(
title = "Taubert - Found subjects"
) %>%
cols_label(
Viral_reference_taxonomy = "Viral reference taxonomy",
Viral_reference_subject = "Viral reference subject",
Count = "Count"
) %>%
row_group(
group = Group
)
combined_subjects <- rbind(rna_subject,smalldna_subject,largedna_subject)
combined_subjects$Group <- c(rep("RNA Viruses", 6), "Small DNA Viruses", rep("Large DNA Viruses", 5))
combined_subjects
rna_subject
smalldna_subject
largedna_subject
combined_subjects$Group <- c(rep("RNA Viruses", 5), "Small DNA Viruses", rep("Large DNA Viruses", 5))
combined_subjects %>%
gt() %>%
tab_header(
title = "Taubert - Found subjects"
) %>%
cols_label(
Viral_reference_taxonomy = "Viral reference taxonomy",
Viral_reference_subject = "Viral reference subject",
Count = "Count"
) %>%
tab_spanner_delim(
label = "RNA Viruses",
delim = "RNA Viruses",
columns = vars(Viral_reference_taxonomy, Viral_reference_subject, Count)
) %>%
tab_spanner_delim(
label = "Small DNA Viruses",
delim = "Small DNA Viruses",
columns = vars(Viral_reference_taxonomy, Viral_reference_subject, Count)
) %>%
tab_spanner_delim(
label = "Large DNA Viruses",
delim = "Large DNA Viruses",
columns = vars(Viral_reference_taxonomy, Viral_reference_subject, Count)
)
VhgTabularRasa(combined_subjects,title = "Taubert - Found subjects",names_ = c("Viral reference taxonomy",
"Viral reference subject",
"Count","Category"),title_colour = "black")
cgt <-  VhgTabularRasa(combined_subjects,title = "Taubert - Found subjects",names_ = c("Viral reference taxonomy",
"Viral reference subject",
"Count","Category"),title_colour = "black")
cgt%>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
combined_subjects %>%
gt() %>%
tab_header(
title = "Taubert - Found subjects"
) %>%
cols_label(
Viral_reference_taxonomy = "Viral reference taxonomy",
Viral_reference_subject = "Viral reference subject",
Count = "Count"
) %>%
# Add a blank row for separation between groups
tab_spanner(
label = "Group",
columns = vars(Viral_reference_taxonomy, Viral_reference_subject, Count)
) %>%
tab_style(
style = cell_fill(color = "lightgray"),
locations = cells_body(
rows = Group == "RNA Viruses"
)
) %>%
tab_style(
style = cell_fill(color = "lightblue"),
locations = cells_body(
rows = Group == "Small DNA Viruses"
)
) %>%
tab_style(
style = cell_fill(color = "lightyellow"),
locations = cells_body(
rows = Group == "Large DNA Viruses"
)
) %>%
# Add group labels above each group
text_transform(
locations = cells_body(rows = Group == "RNA Viruses"),
fn = function(x) {
paste0("<b>RNA Viruses</b><br>", x)
}
) %>%
text_transform(
locations = cells_body(rows = Group == "Small DNA Viruses"),
fn = function(x) {
paste0("<b>Small DNA Viruses</b><br>", x)
}
) %>%
text_transform(
locations = cells_body(rows = Group == "Large DNA Viruses"),
fn = function(x) {
paste0("<b>Large DNA Viruses</b><br>", x)
}
)
cgt|>
tab_row_group(
label = "numbered",
rows = matches("^[0-9]")
) |>
row_group_order(groups = c(NA, "numbered"))
cgt|>
tab_row_group(
label = "numbered",
rows = matches("^[0-12]")
) |>
row_group_order(groups = c(NA, "numbered"))
cgt |>
tab_row_group(
label = "RNA Viruses",
rows = 1:6
)
combined_subjects <- rbind(rna_subject,smalldna_subject,largedna_subject)
combined_subjects <- rbind(rna_subject,smalldna_subject,largedna_subject)
cgt <-  VhgTabularRasa(combined_subjects,title = "Taubert - Found subjects",names_ = c("Viral reference taxonomy",
"Viral reference subject",
"Count"),title_colour = "black")
cgt<- cgt%>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
cgt |>
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
)
cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Center the column names
tab_style(
style = list(
cell_text_align(align = "center")
),
locations = cells_column_labels(columns = everything())
)
cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Center the column names
tab_style(
style = cell_text(align = "center"),
locations = cells_column_labels(columns = everything())
)
cgt|>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
cgt <- cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
gtsave(rna_gt,filename = "cgt_gt.png",path = "output/TaubertDatacombined/plots/rnavirus/Gatherer/")
cgt <- cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
cgt <- cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
combined_subjects <- rbind(rna_subject,smalldna_subject,largedna_subject)
cgt <-  VhgTabularRasa(combined_subjects,title = "Taubert - Found subjects",names_ = c("Viral reference taxonomy",
"Viral reference subject",
"Count"),title_colour = "black")
cgt<- cgt%>%
opt_align_table_header(align = "left") %>%
opt_stylize(style = 4) %>%  # Apply predefined styling
tab_options(
data_row.padding = px(2),
summary_row.padding = px(3),
row_group.padding = px(4),
heading.title.font.size = px(20)
)
cgt <- cgt |>
# Add row groups
tab_row_group(
label = "RNA Viruses",
rows = 1:5
) |>
tab_row_group(
label = "Small DNA Viruses",
rows = 6
) |>
tab_row_group(
label = "Large DNA Viruses",
rows = 7:11
) |>
# Apply custom style for row group labels
tab_style(
style = cell_text(align = "center"),
locations = cells_row_groups(groups = c("RNA Viruses", "Small DNA Viruses", "Large DNA Viruses"))
)
cgt
gtsave(cgt,filename = "cgt_gt.png",path = "output/TaubertDatacombined/")
